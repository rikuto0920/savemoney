<div class="container product-page">
  <!-- „Éë„É≥„Åè„Åö -->
  <nav class="breadcrumb">
    <%= link_to "Âá∫ÂìÅ‰∏ÄË¶ß", students_path %> / <span><%= @student.name %></span>
  </nav>

  <div class="product">
    <!-- Â∑¶ÔºöÁîªÂÉè -->
    <div class="gallery">
      <% if @student.image? %>
        <div class="main-image">
          <%= image_tag @student.image_url, alt: @student.name %>
        </div>
      <% end %>
    </div>

    <!-- Âè≥ÔºöÊÉÖÂ†± -->
    <div class="meta">
      <span class="badge"><%= @student.daigaku %></span>
      <h1 class="title"><%= @student.name %></h1>
      <p class="desc"><%= @student.point %></p>

      <% if @student.tags.present? %>
        <div class="chips">
          <% @student.tags.each do |tag| %>
            <span class="chip"><%= tag.name %></span>
          <% end %>
        </div>
      <% end %>

  <div class="cta">
    <% if user_signed_in? %>
    <% if current_user.already_liked?(@student) %>
      <%= link_to student_like_path(id: @student.id, student_id: @student.id), method: :delete, class: "btn-like active" do %>
        ‚ù§Ô∏è <%= @student.likes.count %>
      <% end %>
    <% else %>
      <%= link_to student_likes_path(id: @student.id, student_id: @student.id), method: :post, class: "btn-like" do %>
        ü§ç <%= @student.likes.count %>
      <% end %>
    <% end %>

    <%= link_to "Âá∫ÂìÅËÄÖ„Éö„Éº„Ç∏„Å∏", user_path(@student.user_id), class: "btn btn-ghost" %>

    <% if current_user == @student.user %>
      <%= link_to "Á∑®ÈõÜ", edit_student_path(@student), class: "btn btn-ghost" %>
      <%= button_to "ÂâäÈô§", student_path(@student),
                    method: :delete,
                    data: { confirm: "Êú¨ÂΩì„Å´ÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü" },
                    class: "btn btn-danger" %>
    <% end %>
  <% else %>
    <div class="like-readonly">ü§ç <%= @student.likes.count %></div>
    <%= link_to "„É≠„Ç∞„Ç§„É≥„Åó„Å¶Á∑®ÈõÜ", new_user_session_path, class: "btn btn-primary" %>
  <% end %>
  </div>


      <ul class="facts">
        <li>Âá∫ÂìÅÊó•ÊôÇÔºö<%= @student.created_at.strftime("%Y-%m-%d %H:%M") %></li>
      </ul>
    </div>
  </div>

  <!-- „ÅÑ„ÅÑ„Å≠„Åó„Åü„É¶„Éº„Ç∂„Éº -->
  <% if @student.liked_users.present? %>
    <div class="likers-card">
      <h3>„ÅÑ„ÅÑ„Å≠„Åó„Åü„É¶„Éº„Ç∂„Éº</h3>
      <ul>
        <% @student.liked_users.each do |user| %>
          <li><%= user.name %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <!-- „Ç≥„É°„É≥„Éà -->
  <div class="comment-wrapper">
    <h3>„Ç≥„É°„É≥„Éà‰∏ÄË¶ß</h3>
    <% @comments.each do |c| %>
      <div class="comment">
        <div class="comment-meta"><%= c.user&.name %></div>
        <div class="comment-body"><%= simple_format(c.content) %></div>
      </div>
    <% end %>

    <% if user_signed_in? %>
      <%= form_with(model: [@student, @comment], local: true, class: "comment-form") do |f| %>
        <%= f.text_area :content, placeholder: "„Ç≥„É°„É≥„Éà„ÇíÂÖ•Âäõ", rows: 3 %>
        <%= f.submit "„Ç≥„É°„É≥„Éà„Åô„Çã", class: "btn btn-primary" %>
      <% end %>
    <% end %>
  </div>

  <div class="mt-20">
  <%= link_to "Âá∫ÂìÅ‰∏ÄË¶ß„Å´Êàª„Çã", students_path, class: "back-to-list" %>
  </div>
</div>
